# Fail2ban filter for Kamiyo API abuse (rate limiting)

[Definition]

# Match rate limit exceeded events
failregex = ^.*"event_type": "rate_limit_exceeded".*"ip": "<HOST>".*$
            ^.*"error": "Rate limit exceeded".*"ip": "<HOST>".*$
            ^.*HTTP.*429.*<HOST>.*$

ignoreregex =

datepattern = ^"timestamp": "%%Y-%%m-%%dT%%H:%%M:%%S
