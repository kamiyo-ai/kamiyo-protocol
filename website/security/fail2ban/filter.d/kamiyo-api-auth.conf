# Fail2ban filter for Kamiyo API authentication failures

[Definition]

# Match authentication failures in API logs
failregex = ^.*"event_type": "auth_failure".*"ip": "<HOST>".*$
            ^.*"error": "Invalid API key".*"ip": "<HOST>".*$
            ^.*"error": "Unauthorized".*"ip": "<HOST>".*$
            ^.*HTTP.*401.*<HOST>.*$

ignoreregex =

datepattern = ^"timestamp": "%%Y-%%m-%%dT%%H:%%M:%%S
